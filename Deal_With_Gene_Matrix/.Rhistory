demo()
pwd()
d
d()
pbmc <- readRDS("/Users/caozhong/Library/Mobile Documents/com~apple~CloudDocs/日常生活/Lily/单细胞测序分析/pbmc_ASS_ILD_HD_cluster.rds")
plot.markers.vln.uct <- VlnPlot(pbmc, features = c("Ncrl", "KLRF1", "CD3D", "SELL", "LKZF2", "LY-6C2", "LY-6C.2", "GZMB", "FASLG"))
library(ggplot2)
library(patchwork)
library(dplyr)
plot.markers.vln.uct <- VlnPlot(pbmc, features = c("Ncrl", "KLRF1", "CD3D", "SELL", "LKZF2", "LY-6C2", "LY-6C.2", "GZMB", "FASLG"))
library(ggplot2)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
library(patchwork)
library(dplyr)
plot.markers.vln.uct <- VlnPlot(pbmc, features = c("Ncrl", "KLRF1", "CD3D", "SELL", "LKZF2", "LY-6C2", "LY-6C.2", "GZMB", "FASLG"))
View(plot.markers.vln.uct)
View(plot.markers.vln.uct)
plot.markers.vln.uct
plot.markers.vln.uct <- VlnPlot(pbmc, features = c("Ncrl", "KLRF1", "CD3D", "SELL", "LKZF2", "LY-6C2", "LY-6C.2", "GZMB", "FASLG", "NCAM1"))
plot.markers.vln.uct
DefaultAssay(pbmc) <- "integrated"
plot.markers.vln.uct <- VlnPlot(pbmc, features = c("Ncrl", "KLRF1", "CD3D", "SELL", "LKZF2", "LY-6C2", "LY-6C.2", "GZMB", "FASLG", "NCAM1"))
install.packages("languageserver")
# . 依赖关系检查、安装和加载
# See whether these packages exist on comp. If not, install.
BiocManager::install("clusterProfiler")
BiocManager::install("MAST")
# . 依赖关系检查、安装和加载
# See whether these packages exist on comp. If not, install.
BiocManager::install("clusterProfiler")
BiocManager::install("org.Hs.eg.db")
BiocManager::install("MAST")
package_list <- c("optparse", "Seurat","SeuratDisk","ggplot2","patchwork", "dplyr", "showtext", "ggprism", "rstatix", "clusterProfiler", "ggpubr", "ggrepel", "DOSE", "ggnewscale")
for(p in package_list){
if(!suppressWarnings(suppressMessages(require(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))){
install.packages(p, repos="http://cran.r-project.org")
suppressWarnings(suppressMessages(library(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))
}
}
# 另两种常见R包安装方法
if (FALSE){
# Bioconductor安装
source("https://bioconductor.org/biocLite.R")
biocLite(c("reshape2"))
# Github安装
install.packages("devtools", repo="http://cran.us.r-project.org")
library(devtools)
install_github("kassambara/ggpubr")
}
source('~/Singel-Cell-Analysis-Review/Deal_With_Gene_Matrix/Exp_Prepare_InstallPackages.r')
#install.packages(p, repos="http://cran.r-project.org")
install.packages(p, repos="https://mirrors.tuna.tsinghua.edu.cn/CRAN")
# . 依赖关系检查、安装和加载
# See whether these packages exist on comp. If not, install.
BiocManager::install("clusterProfiler")
source('~/Singel-Cell-Analysis-Review/Deal_With_Gene_Matrix/Exp_Prepare_InstallPackages.r')
source('~/Singel-Cell-Analysis-Review/Deal_With_Gene_Matrix/Exp_Prepare_InstallPackages.r')
source('~/Singel-Cell-Analysis-Review/Deal_With_Gene_Matrix/Exp_Prepare_InstallPackages.r')
setwd("~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix")
path
library(gplots)
library(gplots)
library(ggplot2)
input_list <- c("/Users/caozhong/tmp/DEG_choose/New/T_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/B_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/CD14_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/CD16_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/NK_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/T_KEGG.csv",
"/Users/caozhong/tmp/DEG_choose/New/B_KEGG.csv")
output_list <- c("T GO ",
"B GO ",
"CD14 GO ",
"CD16 GO ",
"NK GO",
"T KEGG ",
"B KEGG ")
PATH = "TMP"
funppplot <- function(input_name, output_name) {
filename <- input_name
titlename <- paste(output_name, "Enrichment",  sep = "")
savename1 <- paste(output_name, "dotplot_up.pdf",  sep = "")
savename2 <- paste(output_name, "barplot_up.pdf",  sep = "")
ego_up <- read.csv(filename, header = TRUE)
x <- - log(ego_up$p.adjust)
y <- factor(ego_up$Description, levels=rev(unique(ego_up$Description)))
c <- factor(ego_up$Count)
p1 <- ggplot(ego_up, aes(x,y)) +
geom_point(aes(size=Count,color=p.adjust)) +
scale_color_gradient(high = "red", low = "blue", trans = 'reverse') +
labs(color=expression(p.adjust),
size="GeneCount",
x="-LogP",
y="",
title=titlename) +
theme_bw() +
scale_size_continuous(range=c(4,8))
p2 <- ggplot(ego_up, aes(y, c, fill=p.adjust)) +
geom_bar(stat = "identity")  + coord_flip() +
scale_fill_gradient(high = "red", low = "blue", trans = 'reverse') +
labs(color=expression(p.adjust),
x="",
y="GeneCount",
title=titlename) +
theme_bw()
ggsave(savename1, p1, path = PATH, width = 10, height = 7)
ggsave(savename2, p2, path = PATH, width = 10, height = 7)
}
## MAIN
for (i in 1:7){
print (i)
funppplot(input_list[i], output_list[i])
}
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
setwd("~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix")
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
library(gplots)
library(ggplot2)
input_list <- c("/Users/caozhong/tmp/DEG_choose/New/T_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/B_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/CD14_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/CD16_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/NK_GO.csv",
"/Users/caozhong/tmp/DEG_choose/New/T_KEGG.csv",
"/Users/caozhong/tmp/DEG_choose/New/B_KEGG.csv")
output_list <- c("T GO ",
"B GO ",
"CD14 GO ",
"CD16 GO ",
"NK GO",
"T KEGG ",
"B KEGG ")
PATH = "../Figure2_DEG"
if (!dir.exists(PATH)){
dir.create(path = PATH, recursive = TRUE)
}
funppplot <- function(input_name, output_name) {
filename <- input_name
titlename <- paste(output_name, "Enrichment",  sep = "")
savename1 <- paste(output_name, "dotplot_up.pdf",  sep = "")
savename2 <- paste(output_name, "barplot_up.pdf",  sep = "")
ego_up <- read.csv(filename, header = TRUE)
x <- - log(ego_up$p.adjust)
y <- factor(ego_up$Description, levels=rev(unique(ego_up$Description)))
c <- factor(ego_up$Count)
p1 <- ggplot(ego_up, aes(x,y)) +
geom_point(aes(size=Count,color=p.adjust)) +
scale_color_gradient(high = "red", low = "blue", trans = 'reverse') +
labs(color=expression(p.adjust),
size="GeneCount",
x="-LogP",
y="",
title=titlename) +
theme_bw() +
scale_size_continuous(range=c(4,8))
p2 <- ggplot(ego_up, aes(y, c, fill=p.adjust)) +
geom_bar(stat = "identity")  + coord_flip() +
scale_fill_gradient(high = "red", low = "blue", trans = 'reverse') +
labs(color=expression(p.adjust),
x="",
y="GeneCount",
title=titlename) +
theme_bw()
ggsave(savename1, p1, path = PATH, width = 10, height = 7)
ggsave(savename2, p2, path = PATH, width = 10, height = 7)
}
## MAIN
for (i in 1:7){
print (i)
funppplot(input_list[i], output_list[i])
}
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
input_list[1]
input_list[1].endsWith("GO.csv")
endsWith(input_list[1])
endsWith(input_list[1], 'csv')
endsWith(input_list[1], 'GO.csv')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
ego_up
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
filename <- input_list[1]
ego_up <- read.csv(filename, header = TRUE)
ego_up
ego2 <- simplify(ego_up)
cnetplot(ego_up, foldChange=geneList)
library(ggplot2)
library(fgsea)
cnetplot(ego_up, foldChange=geneList)
library(enrichplot)
library("org.Mm.eg.db")
BiocManager::install("org.Mm.eg.db")
library(org.Hs.eg.db)
BiocManager::install("org.Hs.eg.db"
)
cnetplot(ego_up, foldChange=geneList)
library(DOSE)
install.package("DOSE")
install.packages("DOSE")
library(DOSE)
library("DOSE")
library(DOSE)
install.packages("DOSE")
install.packages(DOSE)
library(DOSE)
library(clusterProfiler)
install.packages("clusterProfiler")
library(DOSE)
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_Prepare_InstallPackages.r')
library(ggnewscale)
source('~/.active-rstudio-document')
source('~/Singel-Cell-Analysis-From-Zero/Deal_With_Gene_Matrix/Exp_barplot_with_csv.R')
package_list <- c("optparse", "Seurat","ggplot2","patchwork", "dplyr", "showtext", "ggprism", "rstatix", "clusterProfiler", "ggpubr", "ggrepel", "DOSE", "ggnewscale")
for(p in package_list){
if(!suppressWarnings(suppressMessages(require(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))){
# install.packages(p, repos="http://cran.r-project.org")
install.packages(p, repos="https://mirrors.tuna.tsinghua.edu.cn/CRAN")
suppressWarnings(suppressMessages(library(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))
}
}
install.packages("Seurat")
library("Seurat")
library("dplyr")
install.packages("tidyseurat")
install.packages("dplyr")
install.packages("dplyr")
library("Seurat")
library(enrichplot)
library(org.Hs.eg.db)
library(clusterProfiler)
library(org.Hs.eg.db)
install.packages("DOSE")
library("DOSE")
install.packages("clusterProfiler")
library("clusterProfiler")
install.packages("tibble")
install.packages("tibble")
install.packages("clusterProfiler")
library("clusterProfiler")
library("DOSE")
BiocManager::install("clusterProfiler")
library("clusterProfiler")
.libPaths()
BiocManager::install("clusterProfiler")
install_github("bwlewis/irlba”)
install_github("bwlewis/irlba")
if  (!requireNamespace("remotes",  quietly  =  TRUE))  {
install.packages("remotes")
}
library(devtools)
install_github("kassambara/ggpubr")
install_github("bwlewis/irlba")
update.packages()
update.packages()
